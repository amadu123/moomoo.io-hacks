// ==UserScript==
// @name        SaVeGeModv2
// @namespace    Best Hack 2019
// @version      Last_Version
// @description  By SaVeGe
// @author       Unk
// @match        *://moomoo.io/*
// @match        *://dev.moomoo.io/*
// @match        *://sandbox.moomoo.io/*
// @grant        none
// @require https://greasyfork.org/scripts/368273-msgpack/code/msgpack.js?version=598723
// @require http://code.jquery.com/jquery-3.3.1.min.js
// @require https://code.jquery.com/ui/1.12.0/jquery-ui.min.js
// @require https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.js
// @icon    https://i.pinimg.com/564x/03/73/d8/0373d81ebd45b7822c99a4f089aaf956.jpg
// @downloadURL none
// ==/UserScript==

(() => {
	try {
		class Collection {
			constructor(array = []) {
				this.__array = array;
			}

			fromID(id) {
				return this.__array.filter(thing => thing.id === id);
			}

			get(id) {
				return this.fromID(id)[0];
			}

			has(id) {
				return this.fromID(id).length > 0;
			}

			forEach(callback) {
				this.__array.forEach(callback);
			}
		}

		const canvas = document.getElementById("gameCanvas");
		const ctx = canvas.getContext("2d");

		const players = {};
		let currentID = null;

		let ws;

		function randInt(min, max) {
			const mini = Math.ceil(min);
			return Math.floor(Math.random() * (Math.floor(max) - mini + 1)) + mini;
		}
		function randItem(array) {
			return array[randInt(0, array.length - 1)];
		}

		const modules = new Collection([{
			id: "core",
			name: "Core",
			description: "Welcome to the Moomoo Enhancement Suite made by lemo! All changes you make here will only apply after a refresh.",
			required: true,
			init: () => {
				const example = $($("#linksContainer2").children()[0]);

				const mesLink = example.clone();
				mesLink.text(`MES v${GM_info.script.version}`);
				mesLink.attr("href", "https://github.com/Nebula-Developers/Moomoo-Enhancement-Suite");

				example.after(" | ", mesLink);
			}
		}, {
			id: "tracers",
			name: "Tracers",
			settings: [{
				id: "line_color",
				type: "color",
				name: "Line Color",
				description: "The color of the tracers.",
				default: "#000000"
			}],
			init: () => {
				function drawTracers() {
					Object.values(players).forEach(player => {
						if (currentID === null || players[currentID] === undefined || players[currentID].longID === undefined) return;

						ctx.strokeStyle = color;
						ctx.lineWidth = 3;

						const player2 = players[currentID];

						ctx.beginPath();
						ctx.moveTo(player2.x, player2.y);
						ctx.lineTo(player.x, player.y);
						ctx.stroke();
					});

					window.requestAnimationFrame(drawTracers);
				}
				drawTracers();
			},
		}, {
			id: "auto_chat",
			name: "Automatic Chat",
			description: "Automatically chats certain messages.",
			settings: [{
				id: "messages",
				name: "Message List",
				hover: "You can insert multiple messages with a comma; if you want to say both '1' and '2', put '1,2'.",
				default: "Hello!,Git gud!",
				type: "text",
			}, {
				id: "randomize_messages",
				name: "Randomize Messages",
				default: true,
				type: "checkbox",
			}],
			init: () => {
				let index = 0;
				const messages = config.auto_chat.messages.split(",");

				setInterval(() => {
					if (ws) {
						const toSend = config.auto_chat.randomize_messages ? randItem(messages) : messages[index];

						ws.emit("ch", [
							toSend,
						]);

						index += 1;
						if (index >= messages.length) {
							index = 0;
						}
					}
				}, 3000);
			}
		}, {
			id: "smart_hat",
			name: "Smart Hats",
			description: "This module allows you to equip certain hats at certain times to get the most out of those actions.",
		}, {
			id: "heal",
			name: "Autoheal",
			description: "With this module, you can automatically heal when you get damaged.",
		}, {
			id: "object_map",
			name: "Object Mapper",
			description: "Maps the position of objects to your minimap.",
		}, {
			id: "projectile_blocker",
			name: "Arrow Blocking",
			description: "When you have a shield, this module will prevent arrows from hitting you by equipping it and blocking the arrow.",
		}, {
			id: "coordinates",
			name: "Coordinates",
			description: "Shows your coordinates.",
		}, {
			id: "minimap_biomes",
			name: "Biomes on Minimap",
			description: "Shows the different biomes on the minimap by coloring each region.",
			init: () => {
				$("#mapDisplay").css("background", "url('https://wormax.org/chrome3kafa/moomooio-background.png')");
			},
			deinit: () => {
				$("#mapDisplay").css("background", "rgba(0, 0, 0, 0.25)");
			},
		}, {
			id: "custom_text",
			name: "Custom Text",
			description: "This module lets you change the text of many things.",
			settings: [{
				id: "death",
				name: "Death",
				default: "YOU DIED",
				type: "text",
			}, {
				id: "title",
				name: "Title",
				default: "Moo Moo",
				type: "text",
			}],
			init: () => {
				$("#diedText").text(config.custom_text.death);
				document.title = config.custom_text.title;
			},
		}, {
			id: "ping_display",
			name: "Show Ping",
			description: "Adds the ping counter in-game.",
			init: () => {
				const pingDisplay = $("#pingDisplay");
				pingDisplay.css("top", "3px");
				pingDisplay.css("display", "block");

				$("body").append(pingDisplay);
			}
		}]);

		const config = JSON.parse(localStorage.getItem("mes_config")) || {};
		function setConfig(moduleID, key, value) {
			if (!config[moduleID]) {
				config[moduleID] = {};
			}

			if (!(key === undefined || value === undefined)) {
				config[moduleID][key] = value;
			}

			return localStorage.setItem("mes_config", JSON.stringify(config));
		}
		modules.forEach(module => {
			setConfig(module.id);
		});

		WebSocket = class extends WebSocket {
			constructor(...arg) {
				super(...arg);
				ws = this;

				this.addEventListener("message", event => {
					const data = msgpack.decode(event.data);

					switch (data[0]) {
						case "1":
							currentID = data[1][0];
						case "2":
							players[data[1][0][1]] = {
								longID: data[1][0][0],
								name: data[1][0][2],
								x: data[1][0][3],
								y: data[1][0][4],
								angle: data[1][0][5],
								lastUpdated: Date.now(),
							};
							break;
						case "3":
							for (let i = 0, len = data[1][0].length / 13; i < len; i++) {
								if (!players[data[1][0][0 + i * 13]]) {
									players[data[1][0][0 + i * 13]] = {
										x: data[1][0][1 + i * 13],
										y: data[1][0][2 + i * 13],
										angle: data[1][0][3 + i * 13],
										lastUpdated: Date.now(),
									};
								} else {
									const p = players[data[1][0][0 + i * 13]];
									p.x = data[1][0][1 + i * 13];
									p.y = data[1][0][2 + i * 13],
									p.angle = data[1][0][3 + i * 13],
									p.lastUpdated = Date.now();
								}
							}
							break;
						case "4":
							for (const k in players) {
								if (players[k].longID == data[1][0]) delete players[k];
							}
					}
				});

				this._send = this.send;
				this.send = function () {
					this._send.apply(this, arguments);
				};
				this.emit = function () {
					const input = msgpack.encode(arguments);
					this.send(input);
				}
			}
		};

		let menuOpen = false;

		const gameUI = $("#gameUI");

		const menuButton = $("#allianceButton").clone(false);
		menuButton.children()[0].innerText = "touch_app";
		menuButton.css("right", "450px");
		menuButton.attr("title", `Moomoo Enhancement Script v${GM_info.script.version}`);

		menuButton.on("click", toggleMenu);

		gameUI.append(menuButton);

		const menuWrapper = $("<div/>");

		menuWrapper.css("display", "none");
		menuWrapper.css("width", "100%");
		menuWrapper.css("position", "absolute");
		menuWrapper.css("top", "50%");
		menuWrapper.css("transform", "translateY(-50%)");
		menuWrapper.css("text-align", "center");
		menuWrapper.css("pointer-events", "initial");

		const hackMenu = $("<div/>");
		hackMenu.attr("id", "hackMenu");

		const settingsBox = $("<div/>");
		settingsBox.attr("id", "settingsBox");

		const categoryChoose = $("<select/>");
		categoryChoose.css("width", "30%");
		categoryChoose.append("<option disabled>Choose Category</option>");

		// Add all modules to the module options select...
		modules.forEach(module => {
			const moduleOpt = $("<option/>");

			moduleOpt.attr("value", module.id);
			moduleOpt.text(module.name)

			categoryChoose.append(moduleOpt);
		});

		function makeInput(setting, configVal) {
			const input = $(`<input/>`);

			input.attr("type", setting.type);
			input.attr("name", setting.id);

			input.css("margin", "5px");
			input.css("max-width", "25px");

			const label = $(`<label class="settingRadio" />`);

			label.text(setting.name);
			input.attr("title", setting.hover);

			switch (setting.type) {
				case "text":
					input.css("width", "170px");
					input.css("max-width", "170px");

					input.attr("placeholder", `Default: ${setting.default}`);
					input.val(configVal);

					label.text(setting.name + ":");

					break;
				case "checkbox":
					input.prop("checked", configVal);
					break;
				default:
					input.val(configVal);
			}

			if (setting.type === "text") {
				label.append(input);
			} else {
				label.prepend(input);
			}

			return label;
		}

		categoryChoose.on("change", event => {
			const newmod = modules.get(event.target.value);
			settingsBox.empty();

			const desc = $("<p/>");
			desc.text(newmod.description || `You can change settings for the ${newmod.name} module here.`);
			settingsBox.append(desc);

			if (!newmod.required) {
				const enabledToggle = makeInput({
					type: "checkbox",
					id: "enabled",
					name: "Enable Module",
					hover: "Toggles all functionality in this module.",
				}, config[newmod.id].enabled);
				settingsBox.append(enabledToggle);
			}

			// Append module-provided settings.
			if (newmod.settings) {
				newmod.settings.forEach(setting => {
					settingsBox.append("<br/>");
					settingsBox.append(makeInput(setting, config[newmod.id][setting.id]));
				});
			}
		});

		settingsBox.on("change", event => {
			const target = $(event.target);

			switch (target.attr("type")) {
				case "checkbox":
					return setConfig(categoryChoose.val(), target.attr("name"), target.prop("checked"));
				default:
					return setConfig(categoryChoose.val(), target.attr("name"), target.val());
			}
		});

		categoryChoose.val("core").change();

		hackMenu.append("<h1>Options</h2>");
		hackMenu.append(categoryChoose);
		hackMenu.append(settingsBox);

		menuWrapper.append(hackMenu);
		gameUI.append(menuWrapper);

		$("head").append(`
			<style>
				#hackMenu {
					background-color: rgba(70, 40, 90, 0.75);
					width: 400px;
					height: 400px;
					color: white;
					max-height: calc(100vh - 400px);
					overflow-y: hidden;
					display: inline-block;
					border-radius: 4px;
				}
				#settingsBox {
					height: 300px;
					overflow-y: scroll;
					padding: 25px;
					text-align: left;
					font-size: 18px;
				}
				h1 {
					font-size: 26px;
					text-transform: uppercase;
				}
			</style>
		`);

		function toggleMenu() {
			menuOpen = !menuOpen;
			menuWrapper.css("display", menuOpen ? "block" : "none");
		}

		modules.forEach(module => {
			if (config[module.id].enabled || module.required) {
				if (module.init) {
					module.init();
				} else {
					console.warn(`Module ${module.id} has no initialization.`);
				}
			}
		});
	} catch (e) {
		console.warn(e)
	}
})();

$("#consentBlock").css({display: "none"});
$("#youtuberOf").css({display: "none"});
let newImg = document.createElement("img");
newImg.src = "data:image/jpeg;base64,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";
newImg.style = `position: absolute; top: 30px; left: 30px; z-index: 100000; width: 100px; height: 100px; cursor: pointer;`;
document.body.prepend(newImg);
newImg.addEventListener("click", () => {
       let w = window.open("https://www.youtube.com/channel/UC_vmKTQDX4gCH2dvP_OMhRw?view_as=subscriber", null, `height=650, width=1199, status=yes, toolbar=no, menubar=no, location=no`);
});
$("#gameCanvas").css('cursor', 'url(http://cur.cursors-4u.net/user/use-1/use153.cur), default');

$("#consentBlock").css({display: "none"});
//$("#youtuberOf").css({display: "none"});
$("#mapDisplay").css({background: `url('https://i.imgur.com/fgFsQJp.png')`});
$("#allianceButton").css({background: `url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRGyy2Wgum6uWma6Nsfi9LTfdJrTdHxKii4acnH_MjYw0kbn9T8hw')`});
$("#chatButton").css({background: `url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRGyy2Wgum6uWma6Nsfi9LTfdJrTdHxKii4acnH_MjYw0kbn9T8hw')`});
$("#storeButton").css({background: `url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRGyy2Wgum6uWma6Nsfi9LTfdJrTdHxKii4acnH_MjYw0kbn9T8hw')`});
$("#touch_app").css({background: `url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRGyy2Wgum6uWma6Nsfi9LTfdJrTdHxKii4acnH_MjYw0kbn9T8hw')`});

const pingDisplay = $("#pingDisplay");
pingDisplay.css("top", "3px");
pingDisplay.css("display", "block");
$("body").append(pingDisplay);

document.getElementById("moomooio_728x90_home").style.display = "none";
$("#moomooio_728x90_home").parent().css({display: "none"});

window.onbeforeunload = null;
let mouseX;
let mouseY;

let width;
let height;

setInterval(() => {
  if(clanCrash == 1) {
       doNewSend(["8", [crash(false, 5)]])
      doNewSend(["9", [null]]);
  }
   doNewSend(["testing", [6]]);
}, 100);

setInterval(() => {
  if(clanfake == 1) {
       doNewSend(["9", [null]]);
       doNewSend(["8", [fake(false, 5)]])
   }
   doNewSend(["testing", [6]]);
}, 100);

setInterval(() => {
  if(clanToggle == 1) {
       doNewSend(["9", [null]]);
       doNewSend(["8", [animate(false, 5)]])
      }
   doNewSend(["testing", [6]]);
}, 0);

setInterval(() => {
   if(messagecrash == 1) {
       doNewSend(["ch", [crash(true, 5)]])
   }
}, 0);

setInterval(() => {
   if(messagefake == 1) {
       doNewSend(["ch", [fake(true, 5)]])
   }
}, 0);

setInterval(() => {
   if(autoaim == true) {
       doNewSend(["2", [nearestEnemyAngle]]);
   }
}, 0);

setInterval(() => {
   if(hatToggle == 1) {
       if(oldHat != normalHat) {
           hat(normalHat);
           console.log("Tried. - Hat")
       }
       if(oldAcc != normalAcc) {
           acc(normalAcc);
           console.log("Tried. - Acc")
       }
       oldHat = normalHat;
       oldAcc = normalAcc
   }
}, 25);

function normal() {
   hat(normalHat);
   acc(normalAcc);
}

function aim(x, y){
    var cvs = document.getElementById("gameCanvas");
    cvs.dispatchEvent(new MouseEvent("mousemove", {
        clientX: x,
        clientY: y

    }));
}

let coreURL = new URL(window.location.href);
window.sessionStorage.force = coreURL.searchParams.get("fc");


if (window.sessionStorage.force != "false" && window.sessionStorage.force && window.sessionStorage.force.toString() != "null"){
   document.getElementsByClassName("menuHeader")[0].innerHTML = `Servers <span style="color: red;">Force (${window.sessionStorage.force})</span>`;
}


class ForceSocket extends WebSocket {
         constructor(...args){
             if (window.sessionStorage.force != "false" && window.sessionStorage.force && window.sessionStorage.force.toString() != "null"){
                 let server = window.sessionStorage.force;
                 let sip = "";
                 for (let gameServer of window.vultr.servers){
                     if (`${gameServer.region}:${gameServer.index}:0` == server){
                              sip = gameServer.ip;
                     }
                 }
                 args[0] = `wss://ip_${sip}.moomoo.io:8008/?gameIndex=0`;
                 delete window.sessionStorage.force;
             }

            super(...args);

         }


}

WebSocket = ForceSocket;


var nearestEnemy;
var nearestEnemyAngle;
var isEnemyNear;
var instaSpeed = 255;
var primary;
var secondary;
var foodType;
var wallType;
var spikeType;
var millType;
var mineType;
var trapType;
var boostType;
var turretType;
var spawnpadType;
var autoaim = false;
var tick = 0;
var oldHat;
var oldAcc;
var enemiesNear;
var normalHat;
var normalAcc;
var ws;
var msgpack5 = msgpack;
var boostDir;
let myPlayer = {
   id: null,
   x: null,
   y: null,
   dir: null,
   object: null,
   weapon: null,
   clan: null,
   isLeader: null,
   hat: null,
   accessory: null,
   isSkull: null
};

let healSpeed = 90;
let healSpeed2 = 460;
var messagecrash = 0;
var clanToggle = 0;
var clanCrash = 0;
var clanfake = 0;
var messagefake = 0;
let healToggle = 1;
let healToggle2 = 0;
let hatToggle = 0;

document.msgpack = msgpack;
function n(){
    this.buffer = new Uint8Array([0]);
    this.buffer.__proto__ = new Uint8Array;
    this.type = 0;
}

WebSocket.prototype.oldSend = WebSocket.prototype.send;
WebSocket.prototype.send = function(m){
   if (!ws){
       document.ws = this;

       ws = this;
       socketFound(this);
   }
   this.oldSend(m);
};


function socketFound(socket){
   socket.addEventListener('message', function(message){
       handleMessage(message);
   });
}

function handleMessage(m){
   let temp = msgpack5.decode(new Uint8Array(m.data));
   let data;
   if(temp.length > 1) {
       data = [temp[0], ...temp[1]];
       if (data[1] instanceof Array){
           data = data;
       }
   } else {
     data = temp;
   }
   let item = data[0];
   if(!data) {return};

   if(item === "io-init") {
           let cvs = document.getElementById("gameCanvas");
           width = cvs.clientWidth;
           height = cvs.clientHeight;
           $(window).resize(function() {
               width = cvs.clientWidth;
               height = cvs.clientHeight;
           });
           cvs.addEventListener("mousemove", e => {
               mouseX = e.clientX;
               mouseY = e.clientY;
           });
       }

   if (item == "1" && myPlayer.id == null){
       myPlayer.id = data[1];
   }

   if (item == "33") {
       enemiesNear = [];
       for(let i = 0; i < data[1].length / 13; i++) {
           let playerInfo = data[1].slice(13*i, 13*i+13);
           if(playerInfo[0] == myPlayer.id) {
               myPlayer.x = playerInfo[1];
               myPlayer.y = playerInfo[2];
               myPlayer.dir = playerInfo[3];
               myPlayer.object = playerInfo[4];
               myPlayer.weapon = playerInfo[5];
               myPlayer.clan = playerInfo[7];
               myPlayer.isLeader = playerInfo[8];
               myPlayer.hat = playerInfo[9];
               myPlayer.accessory = playerInfo[10];
               myPlayer.isSkull = playerInfo[11];
           } else if(playerInfo[7] != myPlayer.clan || playerInfo[7] === null) {
               enemiesNear.push(playerInfo);
           }
       }
   }

   isEnemyNear = false;
   if(enemiesNear) {
       nearestEnemy = enemiesNear.sort((a,b) => dist(a, myPlayer) - dist(b, myPlayer))[0];
   }
   if(nearestEnemy) {
       nearestEnemyAngle = Math.atan2(nearestEnemy[2]-myPlayer.y, nearestEnemy[1]-myPlayer.x);
       if(Math.sqrt(Math.pow((myPlayer.y-nearestEnemy[2]), 2) + Math.pow((myPlayer.x-nearestEnemy[1]), 2)) < 300) {
           isEnemyNear = true;
           if(autoaim == false && myPlayer.hat != 7 && myPlayer.hat != 53) {
               normalHat = 6;
               if(primary != 8) {
                   normalAcc = 21
               }
           };
       }
   }
   if(isEnemyNear == false && autoaim == false) {
       normalAcc = 11;
       if (myPlayer.y < 2400){
           normalHat = 15;
       } else if (myPlayer.y > 6850 && myPlayer.y < 7550){
           normalHat = 31;
       } else {
            normalHat = 12;
       }
   }
   if (!nearestEnemy) {
       nearestEnemyAngle = myPlayer.dir;
   }
   if(item == "h" && data[1] == myPlayer.id) {
       if(data[2] < 100 && data[2] > 0 && healToggle == 1) {
           setTimeout( () => {
               place(foodType, null);
           }, healSpeed);

       }
   }

   if(item == "h" && data[1] == myPlayer.id) {
       if(data[2] < 100 && data[2] > 0 && healToggle2 == 1) {
           setTimeout( () => {
               place(foodType, null);
               place(foodType, null);
               place(foodType, null);
               place(foodType, null);
           }, healSpeed2);

       }
   }
   update();
}


function doNewSend(sender){
    ws.send(new Uint8Array(Array.from(msgpack5.encode(sender))));
}

function acc(id) {
    doNewSend(["13c", [0, 0, 1]]);
    doNewSend(["13c", [0, id, 1]]);
}

function hat(id) {
    doNewSend(["13c", [0, id, 0]]);
}


function place(id, angle = Math.atan2(mouseY - height / 2, mouseX - width / 2)) {
    doNewSend(["5", [id, null]]);
    doNewSend(["c", [1, angle]]);
    doNewSend(["c", [0, angle]]);
    doNewSend(["5", [myPlayer.weapon, true]]);
}

function boostSpike() {
    if(boostDir == null) {
        boostDir = nearestEnemyAngle;
    }
    place(spikeType, boostDir + toRad(90));
    place(spikeType, boostDir - toRad(90));
    place(boostType, boostDir);
    doNewSend(["33", [boostDir]]);
}
function boostWall() {
    if(boostDir == null) {
        boostDir = nearestEnemyAngle;
    }
    place(wallType, boostDir + toRad(90));
    place(wallType, boostDir - toRad(90));
    place(boostType, boostDir);
    doNewSend(["33", [boostDir]]);
}
function fourSpike() {
        place(spikeType, myPlayer.dir + toRad(0));
        place(spikeType, myPlayer.dir - toRad(90));
        place(spikeType, myPlayer.dir + toRad(90));
        place(spikeType, myPlayer.dir - toRad(180));
        place(spikeType, myPlayer.dir + toRad(45));
        place(spikeType, myPlayer.dir - toRad(45));
        place(spikeType, myPlayer.dir + toRad(135));
        place(spikeType, myPlayer.dir - toRad(135));
        place(spikeType, myPlayer.dir + toRad(60));
        place(spikeType, myPlayer.dir - toRad(60));
        place(spikeType, myPlayer.dir + toRad(150));
        place(spikeType, myPlayer.dir - toRad(150));
        place(spikeType, myPlayer.dir + toRad(30));
        place(spikeType, myPlayer.dir - toRad(30));
        place(spikeType, myPlayer.dir + toRad(120));
        place(spikeType, myPlayer.dir - toRad(120));
}
function fourSpawnpad() {
       place(spawnpadType, myPlayer.dir + toRad(135));
       place(spawnpadType, myPlayer.dir + toRad(150));
       place(spawnpadType, myPlayer.dir + toRad(165));
       place(spawnpadType, myPlayer.dir + toRad(180));
       place(spawnpadType, myPlayer.dir + toRad(195));
       place(spawnpadType, myPlayer.dir + toRad(210));
       place(spawnpadType, myPlayer.dir + toRad(225));
       place(spawnpadType, myPlayer.dir + toRad(240));
       place(spawnpadType, myPlayer.dir + toRad(255));
       place(spawnpadType, myPlayer.dir + toRad(270));
       place(spawnpadType, myPlayer.dir + toRad(285));
       place(spawnpadType, myPlayer.dir + toRad(300));
       place(spawnpadType, myPlayer.dir + toRad(315));
       place(spawnpadType, myPlayer.dir + toRad(330));
       place(spawnpadType, myPlayer.dir + toRad(345));
       place(spawnpadType, myPlayer.dir + toRad(360));
}

function fourTrap() {
       place(trapType, myPlayer.dir + toRad(135));
       place(trapType, myPlayer.dir + toRad(150));
       place(trapType, myPlayer.dir + toRad(165));
       place(trapType, myPlayer.dir + toRad(180));
       place(trapType, myPlayer.dir + toRad(195));
       place(trapType, myPlayer.dir + toRad(210));
       place(trapType, myPlayer.dir + toRad(225));
       place(trapType, myPlayer.dir + toRad(240));
       place(trapType, myPlayer.dir + toRad(255));
       place(trapType, myPlayer.dir + toRad(270));
       place(trapType, myPlayer.dir + toRad(285));
       place(trapType, myPlayer.dir + toRad(300));
       place(trapType, myPlayer.dir + toRad(315));
       place(trapType, myPlayer.dir + toRad(330));
       place(trapType, myPlayer.dir + toRad(345));
       place(trapType, myPlayer.dir + toRad(360));
}
var repeater = function(key, action, interval, bu) {
   let _isKeyDown = false;
   let _intervalId = undefined;

   return {
       start(keycode) {
           if(keycode == key && document.activeElement.id.toLowerCase() !== 'chatbox') {
               _isKeyDown = true;
               if(_intervalId === undefined) {
                   _intervalId = setInterval(() => {
                       action();
                       if(!_isKeyDown){
                           clearInterval(_intervalId);
                           _intervalId = undefined;
                           console.log("claered");
                       }
                   }, interval);
               }
           }
       },

       stop(keycode) {
           if(keycode == key && document.activeElement.id.toLowerCase() !== 'chatbox') {
               _isKeyDown = false;
           }
       }
   };


}

const healer = repeater(81, () => {place(foodType)}, 0);
const boostPlacer = repeater(70, () => {place(boostType)}, 0);
const spikePlacer = repeater(86, () => {place(spikeType)}, 0);
const millPlacer = repeater(78, () => {place(millType)}, 0);
const turretPlacer = repeater(56, () => {place(turretType)}, 0);
const wallPlacer = repeater(52, () => {place(wallType)}, 0);
const boostSpiker = repeater(71, boostSpike, 0);
const boostWaller = repeater(191, boostWall, 0);
const fourSpiker = repeater(66, fourSpike, 0);
const fourTraper = repeater(219, fourTrap, 0);
const fourSpawnpader = repeater(115, fourSpawnpad, 0);





document.addEventListener('keydown', (e)=>{
   spikePlacer.start(e.keyCode);
   healer.start(e.keyCode);
   boostPlacer.start(e.keyCode);
   boostWaller.start(e.keyCode);
   fourTraper.start(e.keyCode);
   fourSpawnpader.start(e.keyCode);
   fourSpiker.start(e.keyCode);
   boostSpiker.start(e.keyCode);
   millPlacer.start(e.keyCode);
   wallPlacer.start(e.keyCode);
   turretPlacer.start(e.keyCode);

   if (e.keyCode == 79 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       for (let i=0;i<5;i++){
            let angle = myPlayer.dir + toRad(i * 72);
            place(millType, angle)
       }
   }
   if (e.keyCode == 80 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       for (let i=0;i<4;i++){
            let angle = myPlayer.dir + toRad(i * 90);
            place(wallType, angle)
       }
   }
   if (e.keyCode == 72 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       place(turretType, myPlayer.dir + toRad(45));
       place(turretType, myPlayer.dir - toRad(45));
   }

   if (e.keyCode == 115 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       place(spawnpadType, myPlayer.dir + toRad(45));
       place(spawnpadType, myPlayer.dir - toRad(45));
   }

   if (e.keyCode == 188 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       place(wallType, myPlayer.dir + toRad(90));
       place(spikeType, myPlayer.dir + toRad(180));
       place(boostType, myPlayer.dir + toRad(270));
       place(trapType, myPlayer.dir + toRad(270));
       place(millType, myPlayer.dir + toRad(0));
   }
      if (e.keyCode == 18 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       place(millType, myPlayer.dir + toRad(90));
       place(millType, myPlayer.dir + toRad(270));
       place(millType, myPlayer.dir + toRad(0));
   }
    if (e.keyCode == 70 && document.activeElement.id.toLowerCase() !== 'chatbox') {
        place(boostType, myPlayer.dir + toRad(0));
   }
          if (e.keyCode == 120 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       place(millType, myPlayer.dir + toRad(90));
       place(millType, myPlayer.dir + toRad(270));
       place(boostType, myPlayer.dir + toRad(0));
                     place(millType, myPlayer.dir + toRad(90));
       place(millType, myPlayer.dir + toRad(270));
       place(boostType, myPlayer.dir + toRad(0));
                     place(millType, myPlayer.dir + toRad(90));
       place(millType, myPlayer.dir + toRad(270));
       place(boostType, myPlayer.dir + toRad(0));
   }
   if (e.keyCode == 33 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       place(trapType, myPlayer.dir + toRad(45));
       place(trapType, myPlayer.dir - toRad(45));
       place(spikeType, myPlayer.dir + toRad(135));
       place(spikeType, myPlayer.dir + toRad(225));
   }
       if (e.keyCode == 219 && document.activeElement.id.toLowerCase() !== 'chatbox') {
        for (let i=0;i<4;i++){
             let angle = myPlayer.dir + toRad(i * 90);
             place(boostType, angle)
        }
    }


   if (e.keyCode == 16 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       if (myPlayer.y < 2400){
           hat(15);
       } else if (myPlayer.y > 6850 && myPlayer.y < 7550){
           hat(31);
       } else {
            hat(12);
       }
       acc(11);
   }

   if (e.keyCode == 84 && document.activeElement.id.toLowerCase() !== 'chatbox') {
           hat(7);
           acc(21);
   }

   if (e.keyCode == 109 && document.activeElement.id.toLowerCase() !== 'chatbox') {
           hat(7);
           acc(21);
   }
       if (e.keyCode == 220 && document.activeElement.id.toLowerCase() !== 'chatbox') {
           hat(31);
           acc(18)
   }
        if (e.keyCode == 221 && document.activeElement.id.toLowerCase() !== 'chatbox') {
        hat(22);
        acc(19);
    }

   if (e.keyCode == 89 && document.activeElement.id.toLowerCase() !== 'chatbox') {
           hat(6);
           acc(19);
   }
      if (e.keyCode == 71 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       hat(26);
       acc(13);
   }
   if (e.keyCode == 192 && document.activeElement.id.toLowerCase() !== 'chatbox') {
           hat(0);
           acc(0);
   }
       if (e.keyCode == 75 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       hat(20);
       acc(18);
   }
          if (e.keyCode == 187 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       hat(12);
       acc(19);
   }
     if (e.keyCode == 90 && document.activeElement.id.toLowerCase() !== 'chatbox') {
        hat(40);
        acc(19);
    }
   if (e.keyCode == 74 && document.activeElement.id.toLowerCase() !== 'chatbox') {
        hat(53);
        acc(19);
    }
     if (e.keyCode == 73 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       hat(11);
       acc(21);
   }
       if (e.keyCode == 8 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       hat(28);
       acc(8);
   }
   if(e.keyCode == 20 && document.activeElement.id.toLowerCase() !== 'chatbox') {
        autoaim = true;
       doNewSend(["ch", [me(true, 5)]])
           doNewSend(["13c", [0, 11, 0]]);
           doNewSend(["13c", [0, 21, 1]]);

       setTimeout( () => {
           doNewSend(["5", [primary, true]]);
           doNewSend(["13c", [0, 7, 0]]);
           doNewSend(["13c", [0, 0, 1]]);
           doNewSend(["13c", [0, 18, 1]]);
           doNewSend(["c", [1]]);
       }, 100);

       setTimeout( () => {
           doNewSend(["13c", [0, 53, 0]]);
           doNewSend(["5", [secondary, true]]);
       }, 200);

       setTimeout( () => {
           doNewSend(["c", [0]]);
           doNewSend(["5", [primary, true]]);
           doNewSend(["13c", [0, 6, 0]]);
           doNewSend(["13c", [0, 21, 1]]);
           autoaim = false;
       }, 300);
   }


   if(e.keyCode == 85 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       autoaim = true;
           doNewSend(["5", [primary, true]]);
           doNewSend(["13c", [0, 7, 0]]);
           doNewSend(["13c", [0, 0, 1]]);
           doNewSend(["13c", [0, 18, 1]]);
       doNewSend(["ch", [mes(true, 5)]])
           doNewSend(["c", [1]]);

       setTimeout( () => {
           doNewSend(["6", [5]]);
       }, 100);

       setTimeout( () => {
           doNewSend(["13c", [0, 53, 0]]);
       }, 200);

       setTimeout( () => {
           doNewSend(["5", [primary, true]]);
           doNewSend(["c", [0, null]]);
           doNewSend(["13c", [0, 0, 0]]);
           doNewSend(["13c", [0, 6, 0]]);
           doNewSend(["13c", [0, 19, 1]]);
           autoaim = false;
       }, 300);
   }
   if(e.keyCode == 32 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       autoaim = true;
       doNewSend(["5", [primary, true]]);
       doNewSend(["13c", [0, 7, 0]]);
       doNewSend(["13c", [0, 0, 1]]);
       doNewSend(["13c", [0, 18, 1]]);
       place(spikeType, myPlayer.dir + toRad(45));
       place(spikeType, myPlayer.dir - toRad(45));
       doNewSend(["c", [1]]);

       setTimeout( () => {
           doNewSend(["13c", [0, 53, 0]]);
           doNewSend(["ch", [Boom(true, 5)]])
       }, 100);

       setTimeout( () => {
           doNewSend(["c", [0, null]]);
           doNewSend(["13c", [0, 0, 0]]);
           doNewSend(["13c", [0, 6, 0]]);
           doNewSend(["13c", [0, 19, 1]]);
           autoaim = false;
       }, 200);
   }

if(e.keyCode == 67 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       autoaim = false;
       doNewSend(["5", [primary, true]]);
       doNewSend(["13c", [0, 7, 0]]);
       doNewSend(["13c", [0, 0, 1]]);
       doNewSend(["13c", [0, 18, 1]]);
       doNewSend(["c", [1]]);

       setTimeout( () => {
           doNewSend(["13c", [0, 53, 0]]);
       }, instaSpeed - 130);

       setTimeout( () => {
       doNewSend(["5", [primary, true]]);
       doNewSend(["c", [0, null]]);
       doNewSend(["13c", [0, 0, 0]]);
       doNewSend(["13c", [0, 12, 0]]);
       doNewSend(["13c", [0, 11, 1]]);
       autoaim = false;
       }, instaSpeed);
   }

      if(e.keyCode == 82 && document.activeElement.id.toLowerCase() !== 'chatbox') {
        autoaim = true;
        doNewSend(["5", [primary, true]]);
        doNewSend(["13c", [0, 7, 0]]);
        doNewSend(["13c", [0, 0, 1]]);
        doNewSend(["13c", [0, 18, 1]]);
        doNewSend(["ch", [mess(true, 5)]])
        doNewSend(["c", [1]]);

        setTimeout( () => {
            doNewSend(["13c", [0, 53, 0]]);
            doNewSend(["5", [secondary, true]]);
        }, instaSpeed - 130);

        setTimeout( () => {
            doNewSend(["5", [primary, true]]);
            doNewSend(["c", [0, null]]);
            doNewSend(["13c", [0, 0, 0]]);
            doNewSend(["13c", [0, 6, 0]]);
            doNewSend(["13c", [0, 21, 0]]);
            doNewSend(["13c", [0, 19, 1]]);
            place(foodType, myPlayer.dir + toRad(0));
            place(foodType, myPlayer.dir + toRad(0));
             place(foodType, myPlayer.dir + toRad(0));
            place(foodType, myPlayer.dir + toRad(0));
            autoaim = false;
        }, instaSpeed);
    }
            if(e.keyCode == 77 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       autoaim = true;
        doNewSend(["5", [primary, true]]);
        doNewSend(["13c", [0, 26, 0]]);
        doNewSend(["13c", [0, 7, 0]]);
        doNewSend(["13c", [0, 0, 1]]);
                 doNewSend(["ch", [m(true, 5)]])
        doNewSend(["13c", [0, 18, 1]]);
        doNewSend(["c", [1]]);
        setTimeout( () => {
            doNewSend(["13c", [0, 53, 0]]);
            doNewSend(["5", [secondary, true]]);
        }, instaSpeed - 130);

        setTimeout( () => {
            doNewSend(["5", [primary, true]]);
              place(spikeType, myPlayer.dir + toRad(0));
            doNewSend(["c", [0, null]]);
            doNewSend(["13c", [0, 6, 0]]);
            doNewSend(["5", [7]]);
            doNewSend(["c", [1]]);
            doNewSend(["c", [0]]);
            autoaim = false;
        }, instaSpeed);
    }
      if(e.keyCode == 189 && document.activeElement.id.toLowerCase() !== 'chatbox') {
        doNewSend(["6", [5]]);
        doNewSend(["6", [17]]);
        doNewSend(["6", [31]]);
        doNewSend(["6", [23]]);
        doNewSend(["6", [9]]);
        doNewSend(["6", [33]]);
        doNewSend(["6", [28]]);
        doNewSend(["6", [15]]);

    }
        if(e.keyCode == 119 && document.activeElement.id.toLowerCase() !== 'chatbox') {

        doNewSend(["6", [3]]);
        doNewSend(["6", [17]]);
        doNewSend(["6", [31]]);
        doNewSend(["6", [23]]);
        doNewSend(["6", [9]]);
        doNewSend(["6", [33]]);
        doNewSend(["6", [4]]);
        doNewSend(["6", [15]]);
            }

   if(e.keyCode == 38 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       messagecrash = (messagecrash + 1) % 2;
   }

   if(e.keyCode == 37 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       messagefake = (messagefake + 1) % 2;
   }

   if(e.keyCode == 39 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       clanfake = (clanfake + 1) % 2;
   }

   if(e.keyCode == 40 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       clanToggle = (clanToggle + 1) % 2;
   }

   if(e.keyCode == 46 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       clanCrash = (clanCrash + 1) % 2;
   }

   if(e.keyCode == 113 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       healToggle = (healToggle + 1) % 2;
       if(healToggle == 0) {
           if(hatToggle == 0) {
               document.title = "Heal: OFF | Hat: OFF"
           } else {
               document.title = "Heal: OFF | Hat: ON"
           }
       } else {
           if(hatToggle == 0) {
               document.title = "Heal: ON | Hat: OFF"
           } else {
               document.title = "Heal: ON | Hat: ON"
           }
       }
   }

   if(e.keyCode == 114 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       healToggle2 = (healToggle2 + 1) % 2;
       if(healToggle2 == 0) {
           if(hatToggle == 0) {
               document.title = "Heal2: OFF | Hat: OFF"
           } else {
               document.title = "Heal2: OFF | Hat: ON"
           }
       } else {
           if(hatToggle == 0) {
               document.title = "Heal2: ON | Hat: OFF"
           } else {
               document.title = "Heal2: ON | Hat: ON"
           }
       }
   }

   if(e.keyCode == 190 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       autoaim = true;
       doNewSend(["5", [secondary, true]]);
       doNewSend(["ch", [spam(true, 5)]])
       doNewSend(["13c", [0, 53, 0]]);
       doNewSend(["c", [1]]);

       setTimeout( () => {
           doNewSend(["13c", [0, 32, 19]]);
           doNewSend(["13c", [0, 10, 0]]);
           doNewSend(["6", [12]]);

       }, 100);

       setTimeout( () => {
           doNewSend(["6", [15]]);

       }, 200);

       setTimeout( () => {
           doNewSend(["c", [0]]);
           doNewSend(["5", [primary, true]]);
           autoaim = false;
       }, 300);
   }

   if(e.keyCode == 97 && document.activeElement.id.toLowerCase() !== 'chatbox') { ///num1 katana [age 8]
       doNewSend(["6", [4]]);
   }
   if(e.keyCode == 98 && document.activeElement.id.toLowerCase() !== 'chatbox') { ///num2 musket [age 9]
       doNewSend(["6", [15]]);
   }
   if(e.keyCode == 98 && document.activeElement.id.toLowerCase() !== 'chatbox') { ///num2 crossbow [age 8]
       doNewSend(["6", [12]]);
   }
   if(e.keyCode == 105 && document.activeElement.id.toLowerCase() !== 'chatbox') { ///num9 max mill [age 8]
       doNewSend(["6", [28]]);
   }
   if(e.keyCode == 104 && document.activeElement.id.toLowerCase() !== 'chatbox') { ///num8 max wall [age 7]
       doNewSend(["6", [21]]);
   }
   if(e.keyCode == 101 && document.activeElement.id.toLowerCase() !== 'chatbox') { ///num5 spin spike [age 9]
       doNewSend(["6", [25]]);
   }
   if(e.keyCode == 102 && document.activeElement.id.toLowerCase() !== 'chatbox') { ///num6 fast crossbow [age 9]
       doNewSend(["6", [13]]);
   }
   if(e.keyCode == 99 && document.activeElement.id.toLowerCase() !== 'chatbox') { ///num3 great axe [age 8]
       doNewSend(["6", [2]]);
   }
   if(e.keyCode == 113 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       hatToggle = (hatToggle + 1) % 2;
       if(healToggle == 0) {
           if(hatToggle == 0) {
               document.title = "Heal: OFF | Hat: OFF"
           } else {
               document.title = "Heal: OFF | Hat: ON"
           }
       } else {
           if(hatToggle == 0) {
               document.title = "Heal: ON | Hat: OFF"
           } else {
               document.title = "Heal: ON | Hat: ON"
           }
       }
   }
})

document.addEventListener('keyup', (e)=>{
   spikePlacer.stop(e.keyCode);
   boostPlacer.stop(e.keyCode);
   boostWaller.stop(e.keyCode);
   fourTraper.stop(e.keyCode);
   fourSpawnpader.stop(e.keyCode);
   fourSpiker.stop(e.keyCode);
   boostSpiker.stop(e.keyCode);
   millPlacer.stop(e.keyCode);
   turretPlacer.stop(e.keyCode);
   wallPlacer.stop(e.keyCode);
   healer.stop(e.keyCode);
   if(e.keyCode == 71 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       setTimeout( () => {
           doNewSend(["33", [null]]);
           boostDir = null;
       }, 10);
   }
   if(e.keyCode == 66 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       setTimeout( () => {
           doNewSend(["33"]);
       }, 1);
   }
   if(e.keyCode == 219 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       setTimeout( () => {
           doNewSend(["33"]);
       }, 1);
   }
   if(e.keyCode == 115 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       setTimeout( () => {
           doNewSend(["33"]);
       }, 1);
   }
   if(e.keyCode == 191 && document.activeElement.id.toLowerCase() !== 'chatbox') {
       setTimeout( () => {
           doNewSend(["33", [null]]);
           boostDir = null;
       }, 10);
   }
})
function isElementVisible(e) {
   return (e.offsetParent !== null);
}


function toRad(angle) {
   return angle * 0.01745329251;
}

function dist(a, b){
   return Math.sqrt( Math.pow((b.y-a[2]), 2) + Math.pow((b.x-a[1]), 2) );
}

function animate(space, chance) {
   let result = '';
   let characters;
   if(space) {
       characters = 'ixPROx3';
   } else {
       characters = 'ixPROx3';
   }
   if(space) {
       characters = characters.padStart((70 - characters.length) / 6 + characters.length)
       characters = characters.padEnd(30);
   }
   let count = 0;
   for (let i = 0; i < characters.length; i++ ) {
      if(Math.floor(Math.random() * chance) == 1 && characters.charAt(i) != "-" && count < 6 && characters.charAt(i) != " ") {
          result += "&";
          count++
      } else {
          result += characters.charAt(i);
      }
   }
   return result;
}

function crash(space, chance) {
   let result = '';
   let characters;
   if(space) {
       characters = 'ixPROx3Legands';
   } else {
       characters = 'Crash';
   }
   if(space) {
       characters = characters.padStart((70 - characters.length) / 6 + characters.length)
       characters = characters.padEnd(30);
   }
   let count = 0;
   for (let i = 0; i < characters.length; i++ ) {
      if(Math.floor(Math.random() * chance) == 1 && characters.charAt(i) != "-" && count < 6 && characters.charAt(i) != " ") {
          result += "";
          count++
      } else {
          result += characters.charAt(i);
      }
   }
   return result;
}

function fake(space, chance) {
   let result = '';
   let characters;
   if(space) {
       characters = 'SaVeGePro';
   } else {
       characters = 'SaVeGeS';
   }
   if(space) {
       characters = characters.padStart((70 - characters.length) / 6 + characters.length)
       characters = characters.padEnd(30);
   }
   let count = 0;
   for (let i = 0; i < characters.length; i++ ) {
      if(Math.floor(Math.random() * chance) == 1 && characters.charAt(i) != "-" && count < 6 && characters.charAt(i) != " ") {
          result += "";
          count++
      } else {
          result += characters.charAt(i);
      }
   }
   return result;
}

function spam(space, chance) {
   let result = '';
   let characters;
   if(space) {
       characters = 'PiwPiwPaw';
   }
   if(space) {
       characters = characters.padStart((30 - characters.length) / 2 + characters.length)
       characters = characters.padEnd(30);
   }
   let count = 0;
   for (let i = 0; i < characters.length; i++ ) {
      if(Math.floor(Math.random() * chance) == 0 && characters.charAt(i) != "-" && count < 0 && characters.charAt(i) != " ") {
          result += "";
          count++
      } else {
          result += characters.charAt(i);
      }
   }
   return result;
}

function mess(space, chance) {
   let result = '';
   let characters;
   if(space) {
       characters = 'BooM OneShot';
   }
   if(space) {
       characters = characters.padStart((30 - characters.length) / 2 + characters.length)
       characters = characters.padEnd(30);
   }
   let count = 0;
   for (let i = 0; i < characters.length; i++ ) {
      if(Math.floor(Math.random() * chance) == 0 && characters.charAt(i) != "-" && count < 0 && characters.charAt(i) != " ") {
          result += "";
          count++
      } else {
          result += characters.charAt(i);
      }
   }
   return result;
}
function m(space, chance) {
   let result = '';
   let characters;
   if(space) {
       characters = '~|GoT a NOoB|~';
   }
   if(space) {
       characters = characters.padStart((30 - characters.length) / 2 + characters.length)
       characters = characters.padEnd(30);
   }
   let count = 0;
   for (let i = 0; i < characters.length; i++ ) {
      if(Math.floor(Math.random() * chance) == 0 && characters.charAt(i) != "-" && count < 0 && characters.charAt(i) != " ") {
          result += "";
          count++
      } else {
          result += characters.charAt(i);
      }
   }
   return result;
}
function Boom(space, chance) {
   let result = '';
   let characters;
   if(space) {
       characters = 'eZ NoOb';
   }
   if(space) {
       characters = characters.padStart((30 - characters.length) / 2 + characters.length)
       characters = characters.padEnd(30);
   }
   let count = 0;
   for (let i = 0; i < characters.length; i++ ) {
      if(Math.floor(Math.random() * chance) == 0 && characters.charAt(i) != "-" && count < 0 && characters.charAt(i) != " ") {
          result += "";
          count++
      } else {
          result += characters.charAt(i);
      }
   }
   return result;
}

function me(space, chance) {
   let result = '';
   let characters;
   if(space) {
       characters = 'OmG~|R.I.P|~OmG';
   }
   if(space) {
       characters = characters.padStart((30 - characters.length) / 2 + characters.length)
       characters = characters.padEnd(30);
   }
   let count = 0;
   for (let i = 0; i < characters.length; i++ ) {
      if(Math.floor(Math.random() * chance) == 0 && characters.charAt(i) != "-" && count < 0 && characters.charAt(i) != " ") {
          result += "";
          count++
      } else {
          result += characters.charAt(i);
      }
   }
   return result;
}

function mes(space, chance) {
   let result = '';
   let characters;
   if(space) {
       characters = 'eZ AGE 1 Install~|';
   }
   if(space) {
       characters = characters.padStart((30 - characters.length) / 2 + characters.length)
       characters = characters.padEnd(30);
   }
   let count = 0;
   for (let i = 0; i < characters.length; i++ ) {
      if(Math.floor(Math.random() * chance) == 0 && characters.charAt(i) != "-" && count < 0 && characters.charAt(i) != " ") {
          result += "";
          count++
      } else {
          result += characters.charAt(i);
      }
   }
   return result;
}

document.title = "SaVeGe+ixPROx3"

function update() {
    for (let i=0;i<9;i++){
        if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
            primary = i;
        }
    }

    for (let i=9;i<16;i++){
        if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
            secondary = i;
        }
    }

    for (let i=16;i<19;i++){
        if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
            foodType = i - 16;
        }
    }

    for (let i=19;i<22;i++){
        if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
            wallType = i - 16;
        }
    }

    for (let i=22;i<26;i++){
        if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
            spikeType = i - 16;
        }
    }

    for (let i=26;i<29;i++){
        if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
            millType = i - 16;
        }
    }

    for (let i=29;i<31;i++){
        if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
            mineType = i - 16;
        }
    }

    for (let i=31;i<33;i++){
        if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
            boostType = i - 16;
        }
    }

   for (let i=33;i<36;i++){
       if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
           turretType = i - 16;
       }
   }

   for (let i=36;i<37;i++){
       if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
           spawnpadType = i - 16;
       }
   }

   for (let i=37;i<39;i++){
       if (isElementVisible(document.getElementById("actionBarItem" + i.toString()))){
           turretType = i - 16;
       }
   }
}

function createTribe(name) {
   leaveTribe();
   doNewSend(["8", [name]]);
}

function leaveTribe() {
   doNewSend(["9", [null]]);
}


var _msgs = ["1", "2", "3", "4"];
var msgs = _msgs;
var msgCycleSwitch = false;
var shift = false;
var minus = false;
var home = false;
var chat;
var msgNum = 0;

var socket = null;

var scriptSetup = false;

WebSocket = class extends WebSocket {
   constructor(...arg) {
       super(...arg);
       if (!scriptSetup){
           scriptSetup = true;
           styleInit();
           ren_overlay();
           window.onbeforeunload = function (){
               return 'Are you sure you want to leave?';
           };
       }
       socket = this;
   }
};

if (storageAvailable('localStorage')){
  if (!localStorage.getItem("msgs")){
      localStorage.setItem("msgs", JSON.stringify(msgs));
  }else{
      let temp;
      try{
          temp = JSON.parse(localStorage.getItem("msgs"));
      }
      catch (e){
          alert("Invalid Array! Setting default...");
          saveData();
          temp = "";
      }
      if (temp !== ""){
          msgs = temp;
      }
  }
}

const overlay = {};
overlay.keyCode = 36;
overlay.toggle = false;
overlay.inputString = msgs.join("\n");
overlay.tempMsgs = _msgs;

function styleInit() {
   addGlobalStyle(`#chatCyclerUI{padding: 0.2em; margin:0.2em; position: absolute;top: 0;left: 0;width: 30%;
   background-color: rgba(135, 206, 235, 0.35);display:none;box-shadow: 0 5px 8px 0 rgba(170, 130, 180, 0.35), 0 7px 20px 0 rgba(70, 130, 180, 0.35)}`);
   addGlobalStyle(".table{ display: table; text-align: center; width: 100%; height: 80%;}");
   addGlobalStyle(".row{ display: table-row; }");
   addGlobalStyle(`.cell{ display: table-cell; padding: 0px 0.3em;border: 1px solid rgba(0, 0, 0, 0.5);}`);
   addGlobalStyle(`.backRed{background-color:#f14e54}`);
   function addGlobalStyle(css) {
       var head, style;
       head = document.getElementsByTagName('head')[0];
       if (!head) {
           return;
       }
       style = document.createElement('style');
       style.type = 'text/css';
       style.innerHTML = css;
       head.appendChild(style);
   }
}

function toggleOverlay(tf){
   if (tf){
       document.querySelector('#chatCyclerUI').style.display = "block";
    }else{
        document.querySelector('#chatCyclerUI').style.display = "none";
    }
};

function ren_overlay(){
    const title = `<div style="font-size:32px;color:rgba(0, 0, 0, 0.75)">Menu</div>`;
    const descr = `<div>Press HOME to repeat this menu.</div>`;
    const body = `
            <div class="table">
                <div class="row">Message  Settings
                </div>
                <div class="row">
                    <div class="cell" style="vertical-align:middle">Messages</div>
                    <div class="cell" style="vertical-align:middle"><textarea name="overlay_messages" rows=4 cols=32 style="background-color:rgba(135, 206, 235, 0.35);resize:none;  rgba(135, 206, 235, 0.75) padding-left: 0px;border-left-width: 0px;border-top-width: 0px;padding-top: 0px;padding-right: 0px;border-right-width: 0px;padding-bottom: 0px;border-bottom-width: 0px;"></textarea></div>
                </div>
                <div class="row">
                    <div class="cell" style="vertical-align:middle">Save Message </div>
                    <div class="cell" style="vertical-align:middle"><input type="button" name="overlay_update_cycle" value="Save"  style="border-right-width: 0px;border-left-width: 0px;border-top-width: 0px;padding-left: 6px;border-bottom-width: 0px;"></div>
                </div>
                <br>
                <div class="row">Message  Repeat
                </div>
                <div class="row">
                    <div class="cell" style="vertical-align:middle">Repeat<br><span class="overlay_cycle_toggle_value"><span style="font-size:24px;color:rgba(0, 0, 0, 0.75)";>Off</span></span></div>
                    <div class="cell" style="vertical-align:middle"><input type="button" name="overlay_cycle_toggle" value="Repeat"></div>
                </div>
            </div>`;
    const footer = `<div style="font-size:24px;color:rgba(0, 0, 0, 0.75)">AutoChat</div>`;
    const temp = `${title} ${body} ${descr} ${footer}`;
    const d = document.createElement("div")
    d.id = "chatCyclerUI";
    d.innerHTML = temp;
    d.style.zIndex = 999999;
    document.body.appendChild(d);
    const val = document.querySelector('textarea[name="overlay_messages"]');
    val.value = overlay.inputString;
    val.addEventListener('input', function(e) {
        overlay.inputString = e.target.value;
    });
    document.querySelector('input[name="overlay_update_cycle"]').addEventListener('click', function() {
        if (!overlay.inputString){
            overlay.tempMsgs = _msgs;
        }else{
            overlay.tempMsgs = overlay.inputString.split(/\r?\n/);
        }
        msgNum = 99;
        msgs = overlay.tempMsgs;
        saveData();
    });
    document.querySelector('input[name="overlay_cycle_toggle"]').addEventListener('click', function(e) {
        msgCycleSwitch = !msgCycleSwitch;
        if (msgCycleSwitch){
            chat = setInterval(autoChat, 1);
            document.querySelector('.overlay_cycle_toggle_value').innerHTML = `<span style="font-size:24px;color:rgba(0, 0, 0, 0.75)";>On</span>`;
        }else{
            document.querySelector('.overlay_cycle_toggle_value').innerHTML = `<span style="font-size:24px;color:rgba(0, 0, 0, 0.75)";>Off</span>`;
            clearInterval(chat);
            msgNum = 0;
        }
    });
}

function concatBuffers(buffer1, buffer2){
  var tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);
  tmp.set(new Uint8Array(buffer1), 0);
  tmp.set(new Uint8Array(buffer2), buffer1.byteLength);
  return tmp.buffer;
}

const four = Uint8Array.from([4]).buffer;

function autoChat(){
    socket && socket.send(msgpack.encode(["ch", [msgs[msgNum]]]));
    msgNum++;
    if (msgNum >= msgs.length) msgNum = 0;
}

function storageAvailable(type){
    try{
        var storage = window[type],
            x = '__storage_test__';
        storage.setItem(x, x);
        storage.removeItem(x);
        return true;
    }
    catch(e){
        return false;
    }
}

function saveData(){
    if (storageAvailable('localStorage')){
        localStorage.setItem("msgs", JSON.stringify(msgs));
    }
}

window.addEventListener('keydown', function (event){
    if (overlay.toggle) event.stopImmediatePropagation();
    if (!minus && event.keyCode === 19){ //[Pause/Break]
        msgCycleSwitch = !msgCycleSwitch;
        if (msgCycleSwitch){
            chat = setInterval(autoChat, 0);
        }else{
            clearInterval(chat);
            msgNum =0;
        }
        minus = true;
    }
    if (!home && event.keyCode === overlay.keyCode){ //[HOME]
        overlay.toggle = !overlay.toggle;
        toggleOverlay(overlay.toggle);
        home = true;
    }
});

window.addEventListener('keypress', function (event){
    if (overlay.toggle) event.stopImmediatePropagation();
});

window.addEventListener('keyup', function (event){
    if (overlay.toggle) event.stopImmediatePropagation();
    if (event.keyCode == 19){
        minus = false;
    }else if (event.keyCode == 36){
        home = false;
    }
});

var ID_WinterCap = 15;
var ID_AssassinGear = 56;
var ID_Bloodthirster = 55;
var ID_FlipperHat = 31;
var ID_MarksmanCap = 1;
var ID_BushGear = 10;
var ID_SoldierHelmet = 6;
var ID_AntiVenomGear = 23;
var ID_MusketeerHat = 32;
var ID_MedicGear = 13;
var ID_BullHelmet = 7;
var ID_EmpHelmet = 22;
var ID_BoosterHat = 12;
var ID_BarbarianArmor = 26;
var ID_BullMask = 46;
var ID_WindmillHat = 14;
var ID_SpikeGear = 11;
var ID_BushidoArmor = 16;
var ID_SamuraiArmor = 20;
var ID_ScavengerGear = 27;
var ID_TankGear = 40;
//Turret Gear. "Use if you want to"
var ID_TurretGear = 53;

// Keys

var TankGearKey = 90;
var AssassinGearKey = 107;
var BullHelmetKey = 84;
var SoldierHelmetKey = 89;
var TurretKey = 74;
var BoosterHatKey = 187;
var uneqiup = 189;
var SpikeGearKey = 220;
var BushGearKey = 186;
var EmpHelmetKey = 221;
var SamuraiArmorKey = 75;
var ScavengerGearKey = 106;

// Remove all of the ads on the page.

try {
    document.getElementById("moomooio_728x90_home").style.display = "none";
    $("moomooio728x90_home").parent().css({display: "none"});
} catch (e) {
    console.log("There was an error removing the ads.");
}


var menuChange = document.createElement("div");
menuChange.className = "menuCard";
menuChange.id = "mainSettings";
menuChange.innerHTML = `
<div id="simpleModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <span class="closeBtn">&times;</span>
            <h2 style="font-size: 17px;">Hat Settings</h2>
        </div>
        <div class="modal-body" style="font-size: 17px;">
            <div class="flexControl">
                <h3 style="color: red; font-size: 17px;"></h3>
                <h3 class="menuPrompt">Tank: </h3> <input value="${String.fromCharCode(TankGearKey)}" id="tankGear" class="keyPressLow" onkeyup="this.value = this.value.toUpperCase();" maxlength="1" type="text"/>
                <h3 class="menuPrompt">Bull: </h3> <input value="${String.fromCharCode(BullHelmetKey)}" id="bullHelm" class="keyPressLow" onkeyup="this.value = this.value.toUpperCase();" maxlength="1" type="text"/>
                <h3 class="menuPrompt">Soldier: </h3> <input value="${String.fromCharCode(SoldierHelmetKey)}" id="soldier" class="keyPressLow"onkeyup="this.value = this.value.toUpperCase();"  maxlength="1" type="text"/>
                <h3 class="menuPrompt">Turret: </h3> <input value="${String.fromCharCode(TurretKey)}" id="turret" class="keyPressLow" maxlength="1" onkeyup="this.value = this.value.toUpperCase();" type="text"/>
                <h3 class="menuPrompt">Booster: </h3> <input value="${String.fromCharCode(BoosterHatKey)}" id="booster" class="keyPressLow" maxlength="1" onkeyup="this.value = this.value.toUpperCase();" type="text"/>
                <h3 class="menuPrompt">Spike: </h3> <input value="${String.fromCharCode(SpikeGearKey)}" id="spikeg" class="keyPressLow" maxlength="1" onkeyup="this.value = this.value.toUpperCase();" type="text"/>
                <h3 class="menuPrompt">Samurai: </h3> <input value="${String.fromCharCode(SamuraiArmorKey)}" id="samuraiArmor" class="keyPressLow" onkeyup="this.value = this.value.toUpperCase();" type="text"/>
                <h3 class="menuPrompt">Emp: </h3> <input value="${String.fromCharCode(EmpHelmetKey)}" id="empHelmet" class="keyPressLow" onkeyup="this.value = this.value.toUpperCase();" type="text"/>
                <h3 class="menuPrompt">Bush: </h3> <input value="${String.fromCharCode(BushGearKey)}" id="bushGear" class="keyPressLow" onkeyup="this.value = this.value.toUpperCase();" type="text"/>
                <h3 class="menuPrompt">Assassin: </h3> <input value="${String.fromCharCode(AssassinGearKey)}" id="assassinGear" class="keyPressLow" onkeyup="this.value = this.value.toUpperCase();" type="text"/>
                <h3 class="menuPrompt">Scavenger: </h3> <input value="${String.fromCharCode(ScavengerGearKey)}" id="scavengerGear" class="keyPressLow" onkeyup="this.value = this.value.toUpperCase();" type="text"/>
                <hr>
                <h3 style="font-size: 17px;"> Map Settings </h3>

                <label class="container"> Biomes
                    <input type="checkbox" id="myCheck">
                    <span class="checkmark"></span>
                </label>
            </div>
        </div>
        <div class="modal-footer">
            <h3 style="font-size: 17px;">Share this hack with other users!</h3>
            <p>Greasy Fork</p>
        </div>
    </div>
</div>
`
document.body.appendChild(menuChange)


$("#tankGear").on("input", () => {
    var cval = $("#tankGear").val();
    if (cval){
        TankGearKey = cval.toUpperCase();
        TankGearKey = TankGearKey.charCodeAt(0);
        console.log(TankGearKey);
    }
});

$("#scavengerGear").on("input", () => {
    var cval = $("#scavengerGear").val();
    if (cval){
        ScavengerGearKey = cval.toUpperCase();
        ScavengerGearKey = ScavengerGearKey.charCodeAt(0);
        console.log(ScavengerGearKey);
    }
});

$("#assassinGear").on("input", () => {
    var cval = $("#assassinGear").val();
    if (cval){
        AssassinGearKey = cval.toUpperCase();
        AssassinGearKey = AssassinGearKey.charCodeAt(0);
        console.log(AssassinGearKey);
    }
});

$("#empHelmet").on("input", () => {
    var cval = $("#empHelmet").val();
    if (cval){
        EmpHelmetKey = cval.toUpperCase();
        EmpHelmetKey = EmpHelmetKey.charCodeAt(0);
        console.log(EmpHelmetKey);
    }
});

$("#bullHelm").on("input", () => {
    var cval = $("#bullHelm").val();
    if (cval){
        BullHelmetKey = cval.toUpperCase();
        BullHelmetKey = BullHelmetKey.charCodeAt(0);
        console.log(BullHelmetKey);
    }
});

$("#bushGear").on("input", () => {
    var cval = $("#bushGear").val();
    if (cval){
        BushGearKey = cval.toUpperCase();
        BushGearKey = BushGearKey.charCodeAt(0);
        console.log(BushGearKey);
    }
});


$("#samuraiArmor").on("input", () => {
    var cval = $("#samuraiArmor").val();
    if (cval){
        SamuraiArmorKey = cval.toUpperCase();
        SamuraiArmorKey = SamuraiArmorKey.charCodeAt(0);
        console.log(SamuraiArmorKey);
    }
});

$("#soldier").on("input", () => {
    var cval = $("#soldier").val();
    if (cval){
        SoldierHelmetKey = cval.toUpperCase();
        SoldierHelmetKey = SoldierHelmetKey.charCodeAt(0);
        console.log(SoldierHelmetKey);
    }
});

$("#turret").on("input", () => {
    var cval = $("#turret").val();
    if (cval){
        TurretKey = cval.toUpperCase();
        TurretKey = TurretKey.charCodeAt(0);
        console.log(TurretKey);
    }
});

$("#booster").on("input", () => {
    var cval = $("#booster").val();
    if (cval){
        BoosterHatKey = cval.toUpperCase();
        BoosterHatKey = BoosterHatKey.charCodeAt(0);
        console.log(BoosterHatKey);
    }
});

var styleItem = document.createElement("style");
styleItem.type = "text/css";
styleItem.appendChild(document.createTextNode(`
.keyPressLow {
    margin-left: 8px;
    font-size: 16px;
    margin-right: 8px;
    height: 25px;
    width: 50px;
    background-color: #fcfcfc;
    border-radius: 3.5px;
    border: none;
    text-align: center;
    color: #4a4a4a;
    border: 0.5px solid #f2f2f2;
}

.menuPrompt {
    font-size: 17px;
    font-family: 'Hammersmith One';
    color: #4A4A4A;
    flex: 0.2;
    text-align: center;
    margin-top: 10px;
    display: inline-block;
}

.modal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    overflow: auto;
    height: 100%;
    width: 100%;
}

.modal-content {
    margin: 10% auto;
    width: 40%;
    box-shadow: 0 5px 8px 0 rgba(0, 0, 0, 0.2), 0 7px 20px 0 rgba(0, 0, 0, 0.17);
    font-size: 14px;
    line-height: 1.6;
}

.modal-header h2,
.modal-footer h3 {
  margin: 0;
}

.modal-header {
    background: #00FF00;
    padding: 15px;
    color: #fff;
    border-top-left-radius: 5px;
    border-top-right-radius: 5px;
}

.modal-body {
    padding: 10px 20px;
    background: #fff;
}

.modal-footer {
    background: #00FF00;
    padding: 10px;
    color: #fff;
    text-align: center;
    border-bottom-left-radius: 5px;
    border-bottom-right-radius: 5px;
}

.closeBtn {
    color: #ccc;
    float: right;
    font-size: 30px;
    color: #fff;
}

.closeBtn:hover,
.closeBtn:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
}

/* Customize the label (the container) */
.container {
  display: block;
  position: relative;
  padding-left: 35px;
  margin-bottom: 12px;
  cursor: pointer;
  font-size: 16px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* Hide the browser's default checkbox */
.container input {
 position: absolute;
 opacity: 0;
 cursor: pointer;
 height: 0;
 width: 0;
}

/* Create a custom checkbox */
.checkmark {
 position: absolute;
 top: 0;
 left: 0;
 height: 25px;
 width: 25px;
 background-color: #eee;
}

/* On mouse-over, add a grey background color */
.container:hover input ~ .checkmark {
 background-color: #ccc;
}

/* When the checkbox is checked, add a blue background */
.container input:checked ~ .checkmark {
 background-color: #2196F3;
}

/* Create the checkmark/indicator (hidden when not checked) */
.checkmark:after {
 content: "";
 position: absolute;
 display: none;
}

/* Show the checkmark when checked */
.container input:checked ~ .checkmark:after {
 display: block;
}

/* Style the checkmark/indicator */
.container .checkmark:after {
 left: 9px;
 top: 5px;
 width: 5px;
 height: 10px;
 border: solid white;
 border-width: 0 3px 3px 0;
 -webkit-transform: rotate(45deg);
 -ms-transform: rotate(45deg);
 transform: rotate(45deg);
}

`))
document.head.appendChild(styleItem);


$("#adCard").css({display: "none"});


document.addEventListener('keydown', function(e) {
   if (e.keyCode == uneqiup && document.activeElement.id.toLowerCase() !== 'chatbox'){
       console.log("done")
       storeEquip(0);
   } else if (e.keyCode == 27){
       if (modal.style.display = "none") {
           modal.style.display = "block";
       } else {
           modal.style.display = "none";
       }
   } else if (e.keyCode == ScavengerGearKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_ScavengerGearGear);
   } else if (e.keyCode == AssassinGearKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_AssassinGear);
   } else if (e.keyCode == BushGearKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_BushGear);
   } else if (e.keyCode == EmpHelmetKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_EmpHelmet);
   } else if (e.keyCode == TankGearKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_TankGear);
   } else if (e.keyCode == SamuraiArmorKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_SamuraiArmor);
   } else if (e.keyCode == SoldierHelmetKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_SoldierHelmet);
   } else if (e.keyCode == BullHelmetKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_BullHelmet);
   } else if (e.keyCode == BoosterHatKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_BoosterHat);
      } else if (e.keyCode == SpikeGearKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_SpikeGear);
   } else if (e.keyCode == TurretKey && document.activeElement.id.toLowerCase() !== 'chatbox'){
       storeEquip(ID_TurretGear);
   }
})

// Get modal element
var modal = document.getElementById("simpleModal");
// Get close button
var closeBtn = document.getElementsByClassName('closeBtn')[0];

// Events
closeBtn.addEventListener('click', closeModal);
window.addEventListener('click', outsideClick);

// Close
function closeModal() {
 modal.style.display = 'none';
}

// Close If Outside Click
function outsideClick(e) {
 if (e.target == modal) {
   modal.style.display = 'none';
 }
}

var checkbox = document.querySelector("#myCheck")

checkbox.addEventListener('change', function() {
   if (this.checked) {
       $("#mapDisplay").css({background: `url('https://i.imgur.com/fgFsQJp.png')`});
       console.log('checked')
   } else {
       $("#mapDisplay").css({background: `rgba(0, 0, 0, 0.25)`})
       console.log('unchecked')
   }
})
// ==UserScript==
// @name         This is a basic script, just visual moomoo.io changes.
// @namespace    This is a basic script, just visual moomoo.io changes.
// @version      2.2.1
// @match        *://*.moomoo.io/*
// @match        *://dev.moomoo.io/*
// @description  A few changes.
// @author       Alone? Al
// @match        *://sandbox.moomoo.io/*
// @grant        none
// ==/UserScript==


document.getElementById('enterGame').innerHTML = '~| PLAY |~';
document.getElementById("gameName").style.color = "Red";
document.getElementById('loadingText').innerHTML = '. . . . . . . . . Load SaVeGeMod . . . . . . . . . .';
document.getElementById('nameInput').placeholder = "SaVeGe";
document.getElementById('chatBox').placeholder = "SaVeGePro";
document.getElementById("pingDisplay").style.color = "red";
document.getElementById('diedText').innerHTML = '';
document.getElementById('diedText').style.color = "Red";

document.getElementById("storeHolder").style = "height: 1500px; width: 450px;"

document.getElementById('adCard').remove();
document.getElementById('errorNotification').remove();

document.getElementById("leaderboard").style.color = "red";
document.getElementById("gameName").style.color = "Red";
document.getElementById("setupCard").style.color = "Red";
document.getElementById("gameName").innerHTML = "SaVeGeMod"
document.getElementById("promoImg").remove();
document.getElementById("scoreDisplay").style.color = "Red";
document.getElementById("woodDisplay").style.color = "Red";
document.getElementById("stoneDisplay").style.color = "Red";
document.getElementById("killCounter").style.color = "Red";
document.getElementById("foodDisplay").style.color = "Red";
document.getElementById("ageText").style.color = "black";
document.getElementById("allianceButton").style.color = "black";
document.getElementById("chatButton").style.color = "black";
document.getElementById("storeButton").style.color = "black";

$('.menuCard').css({'white-space': 'normal',
                    'text-align': 'center',
                    'background-color': 'rgba(0, 0, 0, 0)',
                    '-moz-box-shadow': '0px 0px rgba(255, 255, 255, 0)',
                    '-webkit-box-shadow': '0px 0px rgba(255, 255, 255, 0)',
                    'box-shadow': '0px 0px rgba(255, 255, 255, 0)',
                    '-webkit-border-radius': '0px',
                    '-moz-border-radius': '0px',
                    'border-radius': '0px',
                    'margin': '15px',
                    'margin-top': '15px'});

$('#menuContainer').css({'white-space': 'normal'});

$('#nativeResolution').css({'cursor': 'pointer'});

$('#playMusic').css({'cursor': 'pointer'});

$('#guideCard').css({'overflow-y': 'hidden',
                     'margin-top': 'auto',
                     'margin-bottom': '30px'});


$('#skinColorHolder').css({'margin-bottom': '30.75px'});

$('.settingRadio').css({'margin-bottom': '30.75px'});



$('#linksContainer2').css({'-webkit-border-radius': '0px 0 0 0',
                           '-moz-border-radius': '0px 0 0 0',
                           'border-radius': '0px 0 0 0',
                           'right': '44%',
                           'left': '44%',
                           'background-color': 'rgba(0, 0, 0, 0)',
                           'text-align': 'center',
                           'bottom': '12px'});

$('#gameName').css({'color': '#000000',
                    'text-shadow': '0 1px 0 rgba(255, 255, 255, 0), 0 2px 0 rgba(255, 255, 255, 0), 0 3px 0 rgba(255, 255, 255, 0), 0 4px 0 rgba(255, 255, 255, 0), 0 5px 0 rgba(255, 255, 255, 0), 0 6px 0 rgba(255, 255, 255, 0), 0 7px 0 rgba(255, 255, 255, 0), 0 8px 0 rgba(255, 255, 255, 0), 0 9px 0 rgba(255, 255, 255, 0)',
                    'text-align': 'center',
                    'font-size': '156px',
                    'margin-bottom': '-30px'});

$('pingDisplay').css({'color': '#000000',
                    'text-shadow': '0 1px 0 rgba(255, 255, 255, 0), 0 2px 0 rgba(255, 255, 255, 0), 0 3px 0 rgba(255, 255, 255, 0), 0 4px 0 rgba(255, 255, 255, 0), 0 5px 0 rgba(255, 255, 255, 0), 0 6px 0 rgba(255, 255, 255, 0), 0 7px 0 rgba(255, 255, 255, 0), 0 8px 0 rgba(255, 255, 255, 0), 0 9px 0 rgba(255, 255, 255, 0)',
                    'text-align': 'center',
                    'font-size': '156px',
                    'margin-bottom': '-30px'});

$('#loadingText').css({'color': '#000000',
                       'background-color': 'rgba(0, 0, 0, 0)',
                       'padding': '8px',
                       'right': '150%',
                       'left': '150%',
                       'margin-top': '40px'});

$('.ytLink').css({'color': '#144db4',
                  'padding': '8px',
                  'background-color': 'rgba(0, 0, 0, 0)'});

$('.menuLink').css({'color': '#144db4'});

$('#nameInput').css({'border-radius': '0px',
                     '-moz-border-radius': '0px',
                     '-webkit-border-radius': '0px',
                     'border': 'hidden'});

$('#serverSelect').css({'cursor': 'pointer',
                        'color': '#000000',
                        'background-color': '#808080',
                        'border': 'hidden',
                        'font-size': '20px'});

$('.menuButton').css({'border-radius': '0px',
                      '-moz-border-radius': '0px',
                      '-webkit-border-radius': '0px'});

$('#promoImgHolder').css({'position': 'absolute',
                          'bottom': '-7%',
                          'left': '20px',
                          'width': '420px',
                          'height': '236.25px',
                          'padding-bottom': '18px',
                          'margin-top': '0px'});

$('#adCard').css({'position': 'absolute',
                  'bottom': '-7%',
                  'right': '20px',
                  'width': '420px',
                  'height': '236.25px',
                  'padding-bottom': '18px'});


$('.menuHeader').css({'color': 'rgba(255, 255, 255, 1)'});

$('#killCounter').css({'color': '#ededed'});

$('#diedText').css({'background-color': 'rgba(0, 0, 0, 0)'});

$('#gameCanvas').css({'background-color': '#f4f4f4'});

$('#allianceButton').css({'color': 'rgba(241, 241, 241, 1)'});

$('#storeButton').css({'color': 'rgba(241, 241, 241, 1)'});

$('#chatButton').css({'color': 'rgba(241, 241, 241, 1)'});

$('.gameButton').css({'-webkit-border-radius': '0px 0 0 0',
                      '-moz-border-radius': '0px 0 0 0',
                      'border-radius': '0px 0 0 0',
                      'background-color': 'rgba(0, 0, 0, 0.4)'});

$('.uiElement, .resourceDisplay').css({'-webkit-border-radius': '0px',
                                       '-moz-border-radius': '0px',
                                       'border-radius': '0px',
                                       'background-color': 'rgba(0, 0, 0, 0.4)'});

$('#chatBox').css({'-webkit-border-radius': '0px',
                   '-moz-border-radius': '0px',
                   'border-radius': '0px',
                   'background-color': 'rgba(0, 0, 0, 0.4)',
                   'text-align': 'center'});

$('#foodDisplay').css({'color': '#ae4d54'});

$('#woodDisplay').css({'color': '#758f58'});

$('#stoneDisplay').css({'color': '#818198'});

$('#scoreDisplay').css({'color': '#c2b17a'});

$('#leaderboard').css({'-webkit-border-radius': '0px',
                       '-moz-border-radius': '0px',
                       'border-radius': '0px',
                       'background-color': 'rgba(0, 0, 0, 0.4)',
                       'text-align': 'center'});

$('#ageText').css({'color': '#ffdfd'});

$('#ageBar').css({'-webkit-border-radius': '0px',
                  '-moz-border-radius': '0px',
                  'border-radius': '0px',
                  'background-color': 'rgba(0, 0, 0, 0.4)'});

$('#ageBarBody').css({'-webkit-border-radius': '0px',
                      '-moz-border-radius': '0px',
                      'border-radius': '0px',
                      'background-color': '#f00'});

$('.storeTab').css({'-webkit-border-radius': '0px',
                    '-moz-border-radius': '0px',
                    'border-radius': '0px',
                    'background-color': 'rgba(0, 0, 0, 0.4)'});

$('#storeHolder').css({'-webkit-border-radius': '0px',
                       '-moz-border-radius': '0px',
                       'border-radius': '0px',
                       'background-color': 'rgba(0, 0, 0, 0.4)'});

$('#allianceHolder').css({'-webkit-border-radius': '0px',
                          '-moz-border-radius': '0px',
                          'border-radius': '0px',
                          'background-color': 'rgba(0, 0, 0, 0.4)'});

$('.actionBarItem').css({'-webkit-border-radius': '0px',
                         'border-radius': '0px',
                         'background-color': 'rgba(0, 0, 0, 0.4)'});

$('#itemInfoHolder').css({'text-align': 'center',
                          'top': '125px',
                          'left': '350px',
                          'right': '350px',
                          'max-width': '666px'});

// document.addEventListener("keydown", function(a) {if (a.keyCode == 8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,96,97,98,100,101,102,103,104,105,106,107,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,144,145,186,187,188,189,190,191,192,219,220,221,222) {document.getElementById("nameInput").value="FERANYZERIR BOT";}}, false);

var myElement = document.querySelector('#nameInput');
myElement.style.backgroundColor = "#fffdfd";
myElement.style.color = "#000000";

var getElement = document.querySelector('#enterGame');
getElement.style.backgroundColor = "#d61818";
getElement.style.color = "#000000";

$('#leaderboard').append('SaVeGeMod');// ==UserScript==
// @name         New Userscript
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  try to take over the world!
// @author       You
// @match        https://discord.com/channels/@me/742657056594722876
// @grant        none
// ==/UserScript==

(function() {
    'use strict';

    // Your code here...
})();